/* 增删改查模板 */
insert into `template_config` (`tc_id`, `name`, `save_path`, `suffix`, `content`, `back_user`) values('19','durc_jspCRUD',NULL,NULL,'<%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\"\r\n    pageEncoding=\"UTF-8\"%>\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\r\n<html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\r\n<title>增删改查列子</title>\r\n</head>\r\n<body>\r\n\r\n	<div class=\"easyui-panel search-panel\">\r\n		 <form id=\"schForm\">\r\n	        <table>\r\n                    <tr>\r\n#foreach($column in $columns)\r\n    #if(!${column.isIdentityPk})\r\n            <td class=\"fm_lab\">${column.javaFieldName}:</td><td><input name=\"${column.javaFieldName}Sch\" type=\"text\"></td>      \r\n    #end\r\n#end\r\n<td><a id=\"schBtn\" href=\"#\" class=\"easyui-linkbutton\" iconCls=\"icon-search\">查询</a></td>\r\n                 </tr>\r\n	        </table>\r\n	    </form>\r\n	</div>\r\n\r\n	<div id=\"toolbar\">\r\n	    <a id=\"addBtn\" href=\"#\" class=\"easyui-linkbutton\" iconCls=\"icon-add\" plain=\"true\">添加</a>\r\n	</div>\r\n    \r\n    <table id=\"dg\"></table>\r\n    \r\n    <div id=\"dlg\" class=\"easyui-dialog\" style=\"width:320px;height:280px;padding:10px 20px\"\r\n            closed=\"true\" modal=\"true\" buttons=\"#dlg-buttons\">\r\n        <form id=\"fm\" method=\"post\">\r\n            <table>\r\n#foreach($column in $columns)\r\n    #if(!${column.isIdentityPk})\r\n        <tr>\r\n            <td class=\"fm_lab\">${column.javaFieldName}:</td><td><input name=\"${column.javaFieldName}\" type=\"text\" class=\"easyui-validatebox\" required=\"true\"></td>\r\n        </tr>\r\n    #end\r\n#end\r\n            </table>\r\n        </form>\r\n    </div>\r\n    <div id=\"dlg-buttons\">\r\n        <a id=\"saveBtn\" href=\"#\" class=\"easyui-linkbutton\" iconCls=\"icon-ok\">保存</a>\r\n        <a id=\"cancelBtn\" href=\"#\" class=\"easyui-linkbutton\" iconCls=\"icon-cancel\">取消</a>\r\n    </div>\r\n    \r\n<jsp:include page=\"../easyui_lib.jsp\"></jsp:include>\r\n<script type=\"text/javascript\">\r\n#set($jq=\"$\") \r\n(function(){\r\nvar that = this;\r\n\r\nvar pk = \'${context.javaPkName}\'; // java类中的主键字段\r\nvar listUrl = ctx + \'list${context.javaBeanName}.do\'; // 查询\r\nvar addUrl = ctx + \'add${context.javaBeanName}.do\'; // 添加\r\nvar updateUrl = ctx + \'update${context.javaBeanName}.do\'; // 修改\r\nvar delUrl = ctx + \'del${context.javaBeanName}.do\'; // 删除\r\nvar submitUrl = \'\'; // 提交URL\r\n\r\nvar toolbarId = \'toolbar\'; // 工具条ID\r\n\r\nvar ${jq}dialog = ${jq}(\'#dlg\'); // 窗口\r\nvar ${jq}form = ${jq}(\'#fm\'); // 表单\r\nvar ${jq}grid = ${jq}(\'#dg\'); // 表格\r\nvar ${jq}schForm = ${jq}(\'#schForm\'); // 查询表单\r\n\r\nvar ${jq}schBtn = ${jq}(\'#schBtn\'); // 查询按钮\r\nvar ${jq}saveBtn = ${jq}(\'#saveBtn\'); // 保存按钮\r\nvar ${jq}cancelBtn = ${jq}(\'#cancelBtn\'); // 取消按钮\r\nvar ${jq}addBtn = ${jq}(\'#addBtn\'); // 添加按钮\r\n\r\n// 初始化表格\r\n${jq}grid.datagrid({    \r\n	url:listUrl\r\n   	,columns:[[\r\n#set($i=0)\r\n#foreach($column in $columns)\r\n    #if($i>0),#end\r\n    #if(!${column.isIdentityPk})\r\n    {field:\'${column.javaFieldName}\',title:\'${column.javaFieldName}\'}\r\n    #set($i=$i+1)\r\n    #end    \r\n#end \r\n   	     ,{field:\'_btn1\',title:\'操作\',align:\'center\',formatter:function(val,row){\r\n   	    	 return \'<a href=\"#\" onclick=\"\'+FunUtil.createFun(that,\'edit\',row)+\' return false;\">修改</a>\'\r\n   	    	 + \'<span class=\"opt-split\">|</span>\'\r\n   	    	 + \'<a href=\"#\" onclick=\"\'+FunUtil.createFun(that,\'del\',row)+\' return false;\">删除</a>\'\r\n   	     }}\r\n   	]]\r\n   	,toolbar:\'#\' + toolbarId\r\n	,pagination:true\r\n	,fitColumns:true\r\n	,singleSelect:true\r\n	,striped:true\r\n    ,pageSize:20\r\n});\r\n\r\n// 初始化事件\r\n${jq}addBtn.click(function(){\r\n	${jq}dialog.dialog(\'open\').dialog(\'setTitle\',\'添加\');\r\n	${jq}form.form(\'reset\');\r\n	submitUrl = addUrl;\r\n});\r\n\r\n${jq}schBtn.click(function(){\r\n	var data = getFormData(${jq}schForm);\r\n	${jq}grid.datagrid(\'load\',data);\r\n});\r\n\r\n${jq}saveBtn.click(function(){\r\n	save();\r\n});\r\n\r\n${jq}cancelBtn.click(function(){\r\n	${jq}dialog.dialog(\'close\');\r\n});\r\n\r\n\r\n// 编辑\r\nthis.edit = function(row){\r\n	if (row){\r\n		${jq}dialog.dialog(\'open\').dialog(\'setTitle\',\'修改\');\r\n		${jq}form.form(\'clear\').form(\'load\',row);\r\n		\r\n		submitUrl = updateUrl + [\'?\',pk,\'=\',row[pk]].join(\'\');\r\n	}\r\n}\r\n\r\n// 保存\r\nthis.save = function(){\r\n	var self = this;\r\n	${jq}form.form(\'submit\',{\r\n		url: submitUrl,\r\n		onSubmit: function(){\r\n			return ${jq}(this).form(\'validate\');\r\n		},\r\n		success: function(resultTxt){\r\n			var result = ${jq}.parseJSON(resultTxt);\r\n			Action.execResult(result,function(result){\r\n				${jq}dialog.dialog(\'close\');// close the dialog\r\n				${jq}grid.datagrid(\'reload\');\r\n			});\r\n		}\r\n	});\r\n}\r\n\r\n// 删除\r\nthis.del = function(row){\r\n	if(row){\r\n		${jq}.messager.confirm(\'确认\',\'确定要删除该数据吗?\',function(r){\r\n			if (r){\r\n				Action.post(delUrl,row,function(result){\r\n					Action.execResult(result,function(result){\r\n						${jq}grid.datagrid(\'reload\');\r\n					});\r\n				});\r\n			}\r\n		});\r\n	}\r\n}\r\n\r\n})();\r\n</script>\r\n</body>\r\n</html>','admin');
